{% extends 'skinly/base.html' %}

{% block title %}{{ product.name }} - Skinly{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<section class="py-3" style="background: var(--accent-beige);">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a href="{% url 'skinly:home' %}" style="color: var(--text-secondary);">Home</a></li>
                <li class="breadcrumb-item"><a href="{% url 'skinly:product_list' %}" style="color: var(--text-secondary);">Products</a></li>
                <li class="breadcrumb-item active" aria-current="page" style="color: var(--primary-gold);">{{ product.name }}</li>
            </ol>
        </nav>
    </div>
</section>

<!-- Product Detail -->
<section class="py-5">
    <div class="container">
        <div class="row">
            <!-- Product Image -->
            <div class="col-lg-6 mb-4">
                <div class="product-image-container">
                    <div class="main-image mb-3">
                        <div class="card" style="border: none; border-radius: 20px; overflow: hidden;">
                            <div class="product-image d-flex align-items-center justify-content-center" style="height: 500px; background: linear-gradient(135deg, var(--accent-beige) 0%, var(--primary-sand) 100%);">
                                <i class="fas fa-image" style="font-size: 6rem; color: var(--text-light);"></i>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Thumbnail images (placeholder for future) -->
                    <div class="thumbnail-images d-flex gap-2">
                        {% for i in "123" %}
                        <div class="thumbnail" style="width: 80px; height: 80px; background: var(--primary-sand); border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease;">
                            <i class="fas fa-image" style="color: var(--text-light);"></i>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            
            <!-- Product Info -->
            <div class="col-lg-6">
                <div class="product-info">
                    <!-- Brand and Stock Status -->
                    <div class="mb-3">
                        <span class="badge me-2" style="background: var(--primary-gold); color: var(--dark-brown); font-size: 0.9rem;">{{ product.brand.name }}</span>
                        {% if product.stock_quantity > 0 %}
                            <span class="badge bg-success">In Stock ({{ product.stock_quantity }} available)</span>
                        {% else %}
                            <span class="badge bg-danger">Out of Stock</span>
                        {% endif %}
                    </div>
                    
                    <!-- Product Name -->
                    <h1 class="display-6 fw-bold mb-3" style="font-family: 'Playfair Display', serif; color: var(--dark-brown);">
                        {{ product.name }}
                    </h1>
                    
                    <!-- Rating -->
                    <div class="rating-section mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <div class="rating me-3">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= avg_rating %}
                                        <i class="fas fa-star" style="color: var(--primary-gold);"></i>
                                    {% else %}
                                        <i class="far fa-star" style="color: var(--primary-gold);"></i>
                                    {% endif %}
                                {% endfor %}
                            </div>
                            <span class="text-muted">{{ avg_rating }} out of 5</span>
                            <span class="text-muted ms-2">({{ reviews.count }} review{{ reviews.count|pluralize }})</span>
                        </div>
                    </div>
                    
                    <!-- Price -->
                    <div class="price-section mb-4">
                        <span class="price display-5 fw-bold" style="color: var(--primary-gold); font-family: 'Playfair Display', serif;">
                            ${{ product.price }}
                        </span>
                    </div>
                    
                    <!-- Product Details -->
                    <div class="product-details mb-4">
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="detail-item p-3" style="background: var(--card-bg); border-radius: 10px; border: 1px solid var(--border-light);">
                                    <strong style="color: var(--text-primary);">Type:</strong><br>
                                    <span style="color: var(--text-secondary);">{{ product.get_product_type_display }}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="detail-item p-3" style="background: var(--card-bg); border-radius: 10px; border: 1px solid var(--border-light);">
                                    <strong style="color: var(--text-primary);">Finish:</strong><br>
                                    <span style="color: var(--text-secondary);">{{ product.get_finish_type_display }}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="detail-item p-3" style="background: var(--card-bg); border-radius: 10px; border: 1px solid var(--border-light);">
                                    <strong style="color: var(--text-primary);">Color:</strong><br>
                                    <div class="d-flex align-items-center">
                                        <div class="color-swatch me-2" style="width: 20px; height: 20px; background: {{ product.color.hex_code }}; border-radius: 50%; border: 1px solid var(--border-light);"></div>
                                        <span style="color: var(--text-secondary);">{{ product.color.name }}</span>
                                    </div>
                                </div>
                            </div>
                            {% if product.skin_type_compatibility %}
                            <div class="col-6">
                                <div class="detail-item p-3" style="background: var(--card-bg); border-radius: 10px; border: 1px solid var(--border-light);">
                                    <strong style="color: var(--text-primary);">Best For:</strong><br>
                                    <span style="color: var(--text-secondary);">{{ product.get_skin_type_compatibility_display }} Skin</span>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Actions -->
                    <div class="product-actions">
                        {% if product.stock_quantity > 0 %}
                            {% if user.is_authenticated %}
                                <!-- Add to Cart Form -->
                                <form method="POST" action="{% url 'skinly:add_to_cart' product.id %}" class="mb-3">
                                    {% csrf_token %}
                                    <div class="d-flex gap-3 align-items-center mb-3">
                                        <div class="quantity-selector">
                                            <label for="quantity" class="form-label fw-semibold" style="color: var(--text-primary);">Quantity:</label>
                                            <select name="quantity" id="quantity" class="form-select" style="width: 80px;">
                                                {% for i in "12345" %}
                                                <option value="{{ forloop.counter }}">{{ forloop.counter }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="d-grid gap-2 d-md-block">
                                        <button type="submit" class="btn btn-primary btn-lg me-2">
                                            <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                                        </button>
                                        
                                        <!-- Wishlist Button -->
                                        <button type="button" class="btn btn-outline-primary btn-lg" 
                                                onclick="toggleWishlist({{ product.id }})" 
                                                id="wishlist-{{ product.id }}">
                                            <i class="{% if product in user.wishlist.all %}fas{% else %}far{% endif %} fa-heart me-2"></i>
                                            {% if product in user.wishlist.all %}Remove from Wishlist{% else %}Add to Wishlist{% endif %}
                                        </button>
                                    </div>
                                </form>
                            {% else %}
                                <div class="alert alert-info" role="alert">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <a href="{% url 'skinly:login' %}" class="alert-link">Sign in</a> to add this product to your cart and get personalized recommendations.
                                </div>
                                <a href="{% url 'skinly:login' %}" class="btn btn-primary btn-lg">
                                    <i class="fas fa-sign-in-alt me-2"></i>Sign In to Purchase
                                </a>
                            {% endif %}
                        {% else %}
                            <div class="alert alert-warning" role="alert">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                This product is currently out of stock. Check back soon!
                            </div>
                        {% endif %}
                        
                        <!-- Share Buttons -->
                        <div class="share-section mt-4">
                            <p class="fw-semibold mb-2" style="color: var(--text-primary);">Share this product:</p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-secondary btn-sm" onclick="shareProduct('facebook')">
                                    <i class="fab fa-facebook-f"></i>
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="shareProduct('twitter')">
                                    <i class="fab fa-twitter"></i>
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="shareProduct('pinterest')">
                                    <i class="fab fa-pinterest"></i>
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="copyProductLink()">
                                    <i class="fas fa-link"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Product Description & Reviews -->
<section class="py-5" style="background: var(--accent-beige);">
    <div class="container">
        <!-- Tabs -->
        <ul class="nav nav-tabs nav-fill mb-4" id="productTabs" role="tablist" style="border-bottom: 2px solid var(--primary-gold);">
            <li class="nav-item" role="presentation">
                <button class="nav-link active fw-semibold" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab" style="color: var(--text-primary); border-color: var(--border-light);">
                    Description
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link fw-semibold" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" style="color: var(--text-primary); border-color: var(--border-light);">
                    Reviews ({{ reviews.count }})
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link fw-semibold" id="ingredients-tab" data-bs-toggle="tab" data-bs-target="#ingredients" type="button" role="tab" style="color: var(--text-primary); border-color: var(--border-light);">
                    Ingredients
                </button>
            </li>
        </ul>
        
        <!-- Tab Content -->
        <div class="tab-content" id="productTabsContent">
            <!-- Description -->
            <div class="tab-pane fade show active" id="description" role="tabpanel">
                <div class="card" style="border: none; border-radius: 15px;">
                    <div class="card-body p-4">
                        <h5 style="color: var(--text-primary); margin-bottom: 1rem;">About {{ product.name }}</h5>
                        <p style="color: var(--text-secondary); line-height: 1.6;">
                            Experience the luxury of {{ product.brand.name }}'s {{ product.name }}. This {{ product.get_product_type_display|lower }} features a {{ product.get_finish_type_display|lower }} finish in the stunning {{ product.color.name }} shade.
                        </p>
                        {% if product.skin_type_compatibility %}
                        <p style="color: var(--text-secondary); line-height: 1.6;">
                            Specially formulated for {{ product.get_skin_type_compatibility_display|lower }} skin types, this product delivers exceptional results while being gentle on your skin.
                        </p>
                        {% endif %}
                        <p style="color: var(--text-secondary); line-height: 1.6;">
                            {{ product.brand.description }}
                        </p>
                        
                        <!-- Key Features -->
                        <div class="key-features mt-4">
                            <h6 style="color: var(--text-primary);">Key Features:</h6>
                            <ul style="color: var(--text-secondary);">
                                <li>Premium {{ product.get_finish_type_display|lower }} finish</li>
                                <li>Long-lasting formula</li>
                                {% if product.skin_type_compatibility %}
                                <li>Perfect for {{ product.get_skin_type_compatibility_display|lower }} skin</li>
                                {% endif %}
                                <li>Cruelty-free and ethically sourced</li>
                                <li>Dermatologist tested</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Reviews -->
            <div class="tab-pane fade" id="reviews" role="tabpanel">
                <div class="reviews-section">
                    {% if user.is_authenticated %}
                        {% if not user_review %}
                        <!-- Add Review Form -->
                        <div class="card mb-4" style="border: none; border-radius: 15px;">
                            <div class="card-header" style="background: var(--primary-sand); border-bottom: 2px solid var(--primary-gold);">
                                <h6 class="mb-0" style="color: var(--text-primary);">
                                    <i class="fas fa-star me-2"></i>Write a Review
                                </h6>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{% url 'skinly:add_review' product.id %}">
                                    {% csrf_token %}
                                    <div class="mb-3">
                                        <label for="rating" class="form-label fw-semibold" style="color: var(--text-primary);">Rating:</label>
                                        <select name="rating" id="rating" class="form-select" required>
                                            <option value="">Select a rating</option>
                                            <option value="5">⭐⭐⭐⭐⭐ Excellent</option>
                                            <option value="4">⭐⭐⭐⭐ Very Good</option>
                                            <option value="3">⭐⭐⭐ Good</option>
                                            <option value="2">⭐⭐ Fair</option>
                                            <option value="1">⭐ Poor</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="comment" class="form-label fw-semibold" style="color: var(--text-primary);">Your Review:</label>
                                        <textarea name="comment" id="comment" class="form-control" rows="4" placeholder="Share your experience with this product..."></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane me-2"></i>Submit Review
                                    </button>
                                </form>
                            </div>
                        </div>
                        {% else %}
                        <!-- User's existing review -->
                        <div class="card mb-4" style="border: 2px solid var(--primary-gold); border-radius: 15px;">
                            <div class="card-header" style="background: var(--primary-gold); color: var(--dark-brown);">
                                <h6 class="mb-0">
                                    <i class="fas fa-user me-2"></i>Your Review
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="d-flex align-items-center mb-2">
                                    <div class="rating me-2">
                                        {% for i in "12345" %}
                                            {% if forloop.counter <= user_review.rating %}
                                                <i class="fas fa-star text-warning"></i>
                                            {% else %}
                                                <i class="far fa-star text-warning"></i>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                    <span class="text-muted small">{{ user_review.created_at|date:"M d, Y" }}</span>
                                </div>
                                {% if user_review.comment %}
                                <p style="color: var(--text-secondary);">{{ user_review.comment }}</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    {% endif %}
                    
                    <!-- Existing Reviews -->
                    {% if reviews %}
                        {% for review in reviews %}
                        <div class="card mb-3" style="border: none; border-radius: 15px;">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <div>
                                        <h6 class="mb-1" style="color: var(--text-primary);">{{ review.user.get_full_name|default:review.user.username }}</h6>
                                        <div class="rating">
                                            {% for i in "12345" %}
                                                {% if forloop.counter <= review.rating %}
                                                    <i class="fas fa-star text-warning"></i>
                                                {% else %}
                                                    <i class="far fa-star text-warning"></i>
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                    <span class="text-muted small">{{ review.created_at|date:"M d, Y" }}</span>
                                </div>
                                {% if review.comment %}
                                <p style="color: var(--text-secondary);">{{ review.comment }}</p>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="text-center py-5">
                            <i class="fas fa-star" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
                            <h5 style="color: var(--text-primary);">No reviews yet</h5>
                            <p class="text-muted">Be the first to review this product!</p>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Ingredients -->
            <div class="tab-pane fade" id="ingredients" role="tabpanel">
                <div class="card" style="border: none; border-radius: 15px;">
                    <div class="card-body p-4">
                        <h5 style="color: var(--text-primary); margin-bottom: 1rem;">Ingredients</h5>
                        <p style="color: var(--text-secondary); line-height: 1.6;">
                            This premium {{ product.get_product_type_display|lower }} is formulated with carefully selected ingredients to ensure the highest quality and performance.
                        </p>
                        <div class="ingredients-list mt-3">
                            <p style="color: var(--text-secondary); font-style: italic;">
                                Water, Cyclopentasiloxane, Dimethicone, Glycerin, Phenyl Trimethicone, Talc, Cetyl Dimethicone, Lauryl PEG-9 Polydimethylsiloxyethyl Dimethicone, Sodium Chloride, Dimethicone/Vinyl Dimethicone Crosspolymer, Phenoxyethanol, Potassium Sorbate, Hexyl Laurate, Polyglyceryl-4 Isostearate, Disodium Stearoyl Glutamate, Tocopheryl Acetate, Aluminum Hydroxide, [+/- May Contain: Mica, Titanium Dioxide (CI 77891), Iron Oxides (CI 77491, CI 77492, CI 77499), Ultramarines (CI 77007)]
                            </p>
                        </div>
                        <div class="safety-info mt-4">
                            <h6 style="color: var(--text-primary);">Safety Information:</h6>
                            <ul style="color: var(--text-secondary);">
                                <li>For external use only</li>
                                <li>Avoid contact with eyes</li>
                                <li>Discontinue use if irritation occurs</li>
                                <li>Store in a cool, dry place</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Similar Products -->
{% if similar_products %}
<section class="py-5">
    <div class="container">
        <h3 class="text-center mb-5" style="font-family: 'Playfair Display', serif; color: var(--dark-brown);">
            You Might Also Like
        </h3>
        
        <div class="row g-4">
            {% for similar_product in similar_products %}
            <div class="col-md-3 col-sm-6">
                <div class="card product-card h-100">
                    <div class="position-relative">
                        <div class="product-image card-img-top d-flex align-items-center justify-content-center" style="height: 200px;">
                            <i class="fas fa-image" style="font-size: 2.5rem; color: var(--text-light);"></i>
                        </div>
                        {% if user.is_authenticated %}
                        <button class="btn btn-link position-absolute top-0 end-0 m-2 text-danger" 
                                onclick="toggleWishlist({{ similar_product.id }})"
                                style="background: rgba(255,255,255,0.9); border-radius: 50%; width: 35px; height: 35px;">
                            <i class="far fa-heart"></i>
                        </button>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        <h6 class="card-title mb-1">{{ similar_product.name }}</h6>
                        <p class="text-muted small mb-2">{{ similar_product.brand.name }}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="price fw-bold" style="color: var(--primary-gold);">${{ similar_product.price }}</span>
                            <div class="rating">
                                {% for i in "12345" %}
                                    {% if forloop.counter <= similar_product.rating %}
                                        <i class="fas fa-star text-warning"></i>
                                    {% else %}
                                        <i class="far fa-star text-warning"></i>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>
                        <a href="{% url 'skinly:product_detail' similar_product.id %}" class="btn btn-outline-primary btn-sm w-100 mt-2">
                            View Details
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Add CSRF token for AJAX requests -->
{% csrf_token %}
{% endblock %}

{% block extra_css %}
<style>
.product-image-container .thumbnail:hover {
    border-color: var(--primary-gold) !important;
    transform: scale(1.05);
}

.nav-tabs .nav-link.active {
    background: var(--primary-gold);
    border-color: var(--primary-gold);
    color: var(--dark-brown) !important;
}

.nav-tabs .nav-link:hover {
    border-color: var(--border-light);
    background: var(--primary-sand);
}

.detail-item {
    transition: all 0.3s ease;
}

.detail-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px var(--shadow-color);
}

.quantity-selector .form-select {
    border-radius: 10px;
    border: 2px solid var(--border-light);
}

.share-section .btn {
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.reviews-section .card {
    transition: all 0.3s ease;
}

.reviews-section .card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px var(--shadow-color);
}

@media (max-width: 768px) {
    .product-actions .d-grid.d-md-block {
        display: grid !important;
    }
    
    .product-actions .btn {
        margin-bottom: 0.5rem;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
// Share functionality
function shareProduct(platform) {
    const url = window.location.href;
    const title = "{{ product.name|escapejs }} - Skinly";
    
    let shareUrl;
    switch(platform) {
        case 'facebook':
            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
            break;
        case 'twitter':
            shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
            break;
        case 'pinterest':
            shareUrl = `https://pinterest.com/pin/create/button/?url=${encodeURIComponent(url)}&description=${encodeURIComponent(title)}`;
            break;
    }
    
    if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }
}

function copyProductLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        // Show temporary success message
        const btn = event.target.closest('button');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-check"></i>';
        btn.classList.add('btn-success');
        
        setTimeout(() => {
            btn.innerHTML = originalHTML;
            btn.classList.remove('btn-success');
        }, 2000);
    });
}

// Thumbnail image switching (when images are added)
document.querySelectorAll('.thumbnail').forEach(thumbnail => {
    thumbnail.addEventListener('click', function() {
        // Remove active class from all thumbnails
        document.querySelectorAll('.thumbnail').forEach(t => t.style.borderColor = 'transparent');
        // Add active class to clicked thumbnail
        this.style.borderColor = 'var(--primary-gold)';
        // Switch main image (implement when images are added)
    });
});

// Tab switching animations
document.querySelectorAll('[data-bs-toggle="tab"]').forEach(tab => {
    tab.addEventListener('shown.bs.tab', function(event) {
        const targetPane = document.querySelector(event.target.getAttribute('data-bs-target'));
        targetPane.style.opacity = '0';
        targetPane.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            targetPane.style.transition = 'all 0.3s ease';
            targetPane.style.opacity = '1';
            targetPane.style.transform = 'translateY(0)';
        }, 50);
    });
});

// Smooth scroll to reviews when review tab is clicked
document.getElementById('reviews-tab').addEventListener('click', function() {
    setTimeout(() => {
        document.getElementById('productTabs').scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
        });
    }, 100);
});

// Update wishlist button text
function updateWishlistButton(productId, action) {
    const button = document.getElementById(`wishlist-${productId}`);
    const icon = button.querySelector('i');
    const text = button.childNodes[2]; // Text node after icon
    
    if (action === 'added') {
        icon.classList.remove('far');
        icon.classList.add('fas');
        button.childNodes[2].textContent = 'Remove from Wishlist';
    } else {
        icon.classList.remove('fas');
        icon.classList.add('far');
        button.childNodes[2].textContent = 'Add to Wishlist';
    }
}

// Override the global toggleWishlist function for this page
function toggleWishlist(productId) {
    fetch(`{% url 'skinly:toggle_wishlist' 0 %}`.replace('0', productId), {
        method: 'POST',
        headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        updateWishlistButton(productId, data.action);
        
        // Show temporary notification
        const notification = document.createElement('div');
        notification.className = 'alert alert-success position-fixed';
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; opacity: 0; transition: opacity 0.3s ease;';
        notification.innerHTML = `<i class="fas fa-heart me-2"></i>Product ${data.action} wishlist!`;
        document.body.appendChild(notification);
        
        setTimeout(() => notification.style.opacity = '1', 100);
        setTimeout(() => {
            notification.style.opacity = '0';
            setTimeout(() => document.body.removeChild(notification), 300);
        }, 3000);
    })
    .catch(error => console.error('Error:', error));
}
</script>
{% endblock %}